Structural Motif Detection on the Scale of the Protein Universe with Folddisco

Protein structural motifs are recurring patterns, which are usually short and involved in conserved functions including small-molecule binding, enzyme catalytic activity and recruitment of interaction partners. These structural motifs can occur within unconserved sequences or exist as discontinuous patches within the sequence context, which makes them often difficult to detect by sequence alignment methods. As a solution to deal with the discontinuity of structure motifs, graph-based or disjoint segment-utilizing methods were classically developed to tackle this problem. However, these methods pose a high computational burden, limiting the ability to use them at scale on millions of structures.

Classic inverted index-based search maps from each known structural motif to all proteins in a given database, which contain that motif and the locations of its appearance within them. This approach saves the geometric feature of residue pairs including distance, bond angles, and rotation vectors as index key and two indices with structure identifier as value in the index. Its main advantage over graph-based and alignment methods is its constant search time. This type of search has been offered by the RCSB PDB. However, its application is confined to the PDB and requires grand storage capacities for larger protein structural databases like the AlphaFold database or the ESMatlas.

Here, we present Folddisco, a novel inverted-index based method that overcomes previous methods’ limitations and allows for the first time to detect structural motifs within thousands of proteomes or databases of many million structures. Folddisco has been designed to minimize the size of the inverted index so that even the whole AlphaFold database can fit on a single disk to enable proteome-level motif search in a single machine. To do so, Folddisco introduces several innovations: (1) it reduces over 70% of the required space by not saving the location information within each protein, (2) side-chain orientation capturing feature is introduced for better precision, (3) it accelerates indexing and searching speed by optimizing the index structure.

We employed a record-level index, which omits the residue position of pairwise features, in our index format to reduce the index size to cover hundreds of million proteins within a single disk. To ensure sufficient sensitivity with less false positives in index lookup results, we adjusted the pairwise feature to be able to represent the orientation of interacting side chains in residue pairs. In combination with new angle encoding and frequency-based scoring, Folddisco achieved higher F1-scores compared to pyScoMotif, a python implementation of PDB’s motif search, in querying serine protease active sites (0.88 to 0.67) and zinc finger motifs (0.58 to 0.26) against AlphaFold human proteome. Indexing of human proteome took 22 minutes in building a 2.45GB index, which was 66% faster compared to pyScoMotif’s index. We could build the index of PDB within the 23GB, which is 68% reduction from pyScoMotif and 95% from PDB’s index. Additionally, we have built a 81 GB index of 2.3 million AlphaFoldDB cluster representatives. With these indices, we could find metal binding motifs with partial conservation of zinc finger motif, which was known to be exclusive property of eukaryotes until recently.

We developed Folddisco in Rust programming language with support for multi-threading in most of the steps from indexing to graph-based residue matching. Folddisco supports multiple types of pairwise features including the features used in PDB motif search and trRosetta model. We expect Folddisco to be useful for functional site scaffolding and evolutionary analysis of short structural units. 

Structural Motif Detection on the Scale of the Protein Universe with Folddisco

Protein structural motifs are short, evolutionarily-conserved patterns of atoms involved in protein functions. These motifs are usually discontinuous in sequence making them difficult to detect by structural alignment methods like Foldseek. Graph-based, disjoint segment-utilizing methods are more sensitive but computationally intense. Inverted index-based motif search, such as offered by the RCSB, provides constant search time but would require substantial storage for large predicted protein structure databases, such as the AlphaFoldDB and ESMAtlas.

Here, we present Folddisco, a novel inverted-index based method that overcomes previous methods’ limitations and allows for the first time to detect structural motifs within databases representing the whole protein universe. Folddisco minimizes the size of the inverted index, allowing the full AlphaFoldDB to fit on a single disk for protein-universe-scale motif search in a single machine. To do so, Folddisco introduces several innovations by (1) reducing inverted-index storage space by 70% by omitting location information, (2) improving precision with a novel feature for capturing side-chain orientation, (3) offering fast searching speed with a highly optimized index structure.

Folddisco is free and open source Rust software available at https://folddisco.foldseek.com.

---
Authors: Hyunbin Kim, Seongeun Kim, Milot Mirdita, Martin Steinegger
Keyword (3 or more): structure analysis, structural motif search, data structures, inverted index, AlphaFold2, protein structure, protein structure motif,
Field : Protein/RNA structure analysis


